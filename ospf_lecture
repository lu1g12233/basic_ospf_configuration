OSPF - Open Shortest Path First, is a dynamic routing protocol widely used on the internet. 
It is designed for TCP/IP internet environments and an Interior Gateway Protocol (IGP). 
It is also based on link-state or SPF technology. 

Features of OSPF
-support authentication
-utilizes IP multicast
-responds quickly to topology changes
-supports heirarchical routing
-allows route summarization
-support equal-cost multi-path

OSPFv2 - designed for routing IPv4 networks. 
-RFC2328
-Supports simple authentication and MD5 authentication
-Supports IPv4 only
-Runs on IPv4 transport
-Uses 7 types of LSAs

LSA Types for OSPFv2
1 - Router LSA
2 - Network LSA
3 - Network summary LSAs
4 - ASBR Summary LSA
5 - AS-External LSA
6 - Grouping Membership LSA
7 - NSSA External LSA

OSPFv3 - initially routing IPv6 but can now be used for IPv4 routing of networks. 
-RFC5340 - runs on IPv6 transport
-Initially supports IPv6 but can now support routing for IPv4 and IPv6 in RFC5838
-No built-in authetication and uses IPSec for authentication
-Uses 9 Types of LSAs

LSA Types for OSPFv3
0x2001 - Router LSA
0x2002 - Network LSA
0x2003 - Intra-Area Prefix LSA
0x2004 - Inter-Area Router LSA
0x2005 - AS-External LSA
0x2006 - Group Membership LSA
0x2007 - Type-7 LSA
0x2008 - Link LSA
0x2009 - Intra-area Prefix LSA


How OSPF Works
1. Exhange Topology information with other neighbors as Link State Advertisements (LSAs).
2. Creates topology map for the network know as Link State DAtabase (LSDB)
3. Calculate and find out the best paths.


OSPF Network Types - OSPF routing domain can be made up of various typees of network links.
Different network Types have been introduced for optimizing OSPF's performance based on the physical media of each OSPF interface.

Broadcast 
- Ethernet
-netowrk that supports multiple devices and broadcast or multicast packets sent by one device in the network can be received byt all or some of the other devices.
-automatically discover ospf neighbors
-default Hello interval is 10s default DeadInterval is 40s
-Elects Designated Router and Backup Designated Router

DR and BDR Function
- to reduce the number of adjacencies 
- to reduce the amount of routing protocol traffic and the size of the LSDB. 
- without DR and BDR all routers will need to have adjacency with each other (full mesh). 
- with DR and BDR all routers will form adjacency direct to DR and BDR only which serves as the central point for exchanging OSPF routing information between routers on the same segment.

DR Election
-highest priority value
-highest router id if there is a tie on the Priority value
 
BDR Election
- the second highest Priority
- the second highest router ID if there is a tie on a Priority.

DROTHER
- routers that are part of the ospf but did not win the DR/BDR Election
- manually setting the priority value of a router to 0 will automatically not participate in the election and becomes DROTHER

Default Priority value per Vendor
Cisco IOS - 1
Juniper - 128
Mikrotik - 1 
Huawei - 1


Point-to-point 
-HDLC
-PPP
- consist only of two devices connected by a point-to-point link.
- routers automatically discover neighbors
- default HelloInterval is 10s and DeadInterval is 40s
- no DR/BDR election needed.
- ospf packets are sent to multicast address 224.0.0.5/FF02::5

Non-Broadcast Multi-Access
-Asynchronus Transfer Mode (ATM)
-Frame Relay
-X.25
-network that supports multiple devices but does not have broadcast capability
-requires manual configuration of neighbors
- default HelloInterval is 30s and DeadInterval is 120s
- uses DR/BDR election the router with the highest RouterID. 
- OSPF Packets are sent in unicast instead of multicast.

Point-to-Multipoint
- No network is point-to-multipoint by default. 
- network can be manually configured to become a point-to-multipoint.
- a method of configuration that allows ospf to operate as if the wouter were connected via a point-to-point links instead of NBMA
- suitable for hub and spoke topology
- automatically discovers neighbors
- default HelloInterval is 30s and DeadInterval is 120s
- No DR/BDR
- Hello packets are sent to multicast address 224.0.0.5/FF02::5
- DBD, LSR, LSU and LSAck packets are sent to the neighbors unicast address. 


OSPF Neighbor States - is the state of a converstation being held with a neighboring router.
DOWN 
- the initial state of a neighbor. Indicates no recent information received from the neighbor,
- Hello packets can still be sent to discover the neighbors
START (ATTEMPT)
- attempt state is only valid for neighbors attached to NBMA networks.
- Indicates no recent information received from the neighbor. 
- More concerted effort should be made eto contact the neighor.
INiT 
- a Hello packet has recently been seen from the neighbor.
TWO-WAY
- indicates that the router now has two-way communication with a neighbor by seeing its own RouterID in the list of known neighbors in the received Hello packet through HELLO PROTOCOL.
- final state for neighbors between DROTHERS.
(DR AND BDR ELECTION WILL HAPPEN AFTER THIS STATE IF REQUIRED)
EXSTART
- this is the  first step in creating an adjacency between the two neighboring routers. 
- LSDB exchange
- the goal of this step is to decide which router is the master and to decide the initial DD sequence number. Sequence number is used
to make sure that the routers receive the latest and most recent information
(NEIGHBOR CONVERSATIONS IN THIS STATE ARE CALLED ADJACENCIES WHICH MEANS NEGOTIATIONS ARE DONE)
EXCHANGE
-the router is describing its entire link state database by sending DBD packets to its neighbor
LOADING
- LRD packets are sent to the neighbor asking for the more recent LSAs that have been discovered but not yet received in the Exchange State. 
FULL 
-indicates that the neighbor is now fully adjacent and LSDB synchronization has completed.
- final state for all adjacencies in the where network type does not use DR/BDR
- also the final state for all adjacencies between DR/BDR and DROTHER where the network type uses DR/BDR.


Bringing UP OSPF Adjacencies

<<ROUTER01>>-------------<<ROUTER02>>

- Router 1 wil send Hello Packet to Router 2 with no neighbor listed. neighbor = null
DOWN                       DOWN
- Router 2 will send Hello Packet to Router 1. Hello Packet neighbor = R1
INIT                       INIT
- DR/BDR Election will be performed if needed 
- Routers will check if they will form adjacency. 
- if NO, the will be stuck in 2-WAY STATE. 
- If Yes, they will EXCHANGE ROUTING INFORMATION.
EXSTART                     EXSTART
- Router will send empty DBD Packets where DD sequence, Initialize, More and Master Slave is set. 
Master/Slave Negotiation - ensures reliable packet transmission
Master
-router with highest router ID
-defines the sequence number
-increases the sequence number by 1 each time it sends a new DBD packet
Slave
-router with lower Router ID.
-acknowledges the packet by sending a DBD packet with same DD sequence number
EXCHANGE                 EXCHANGE
- Router 1 will send a DBD packet to Router 2 to transmit LSA Summaries
- Router 2 will send a BDB packet to Router 1 that contains the LSA Summaries.
- Depending on the size of the DBD packet multiple transmission may occur
- If Slave Router1 acknowledge that it has missed some recent LSA.
LOADING                   LOADING
- Router 1 will send LSR to Router to to request the missing LSAs
- Router 2 will check if it's DBD is complete and will send the LSU to Router 1
FULL                      FULL
- Router 1 acknowledges the LSU and further request for LSR 


OSPF Working Process
1. Say Hello
- Routers configured with OSPF will send Hello Packets 
- Hello Packet contains basic information such as
  - Router ID
  - Area ID
  - Hello and Dead Intervals
  - OSPF Options
  - Router Priority
  - Known Neighbors
2. Become Neigbors
- OSPF version2 requires the same subnet mask
- OSPF version3 requires the same instance ID
3. Exchange topology information
- LSDB synchronization
- LSR, LSU, DBD packets will be exchanged
- Each router in the OSPF will build its own LSDB. 
4. Build Topology Map
- Routers will calculate the cost going to every destination.
5. Find the BEST PATH
- Will use the SPF Algorithm to check the best path based on the total COST to reach the destination.


OSPF AREA ID
- a logical grouping of contiguous networks and hosts to be group together. 
- each area runs a separate copy of the basic Link-State routing Algorithm.
- to restric the propagation of routes
- ro reduce the amount of resource required by each router to maintain its LSDB.
- 32 bit number that can be written in dotted decimal notation 0.0.0.X
- all routers with the same area have the same topology table for the area they belong to.
- routers connected to multiple areas have separate topology table for each area and it can also perfrom route summarization and filtering.
Area 0 
- is the BACKBONE AREA
- responsible for distributing routing information between non-backbone areas.
Other Areas
- non-backbone area and must be connected to backbone Area0


OSPF ROUTERS
Internal Router
- Router with all directly connected networks belonging to the same area.
Area Border Router
- A router that attaches to multiple areas.
Backbone Router
- Router that has an interface in the backbone area 
Autonomus System Bounday Router
- A router that exchanges routing information with routers belong to other Autonomous System or Non-OSPF router.
